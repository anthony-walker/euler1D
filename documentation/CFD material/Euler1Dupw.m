%---------------------------------%Shock Tube Problem%upwind-van Leer flux splitting% ME 667% Sourabh V. Apte%---------------------------------%nx=81; maxstep=40%nx=64; maxstep=32%nx=128; maxstep=64nx=256; maxstep=128%nx=512; maxstep=256gg=1.4;p_left=100000;p_right=10000;r_left=1;r_right=0.125;xl=10.0;h=xl/(nx-1);time=0;for i=1:nx,x(i)=h*(i-1);endr=zeros(1,nx);ru=zeros(1,nx);rE=zeros(1,nx);rn=zeros(1,nx);run=zeros(1,nx);rEn=zeros(1,nx);c=zeros(1,nx);u=zeros(1,nx);m=zeros(1,nx);for i=1:nx,r(i)=r_right;ru(i)=0.0;rE(i)=p_right/(gg-1);endfor i=1:nx/2;	r(i)=r_left;	rE(i)=p_left/(gg-1);endrn=r;run=ru;rEn=rE;dt=0.465*h/sqrt(1.4*max([700+p_right/r_right,700+p_left/r_left]) )for istep=1:maxstepfor i=1:nx,c(i)=sqrt( gg*(gg-1)*(rE(i)-0.5*(ru(i)^2/r(i)))/r(i) );endfor i=1:nx,u(i)=ru(i)/r(i);end; for i=1:nx,m(i)=u(i)/c(i);endfor i=2:nx-1					%upwind rn(i)=r(i)-(dt/h)*(... (0.25*r(i)*c(i)*(m(i)+1)^2) - (0.25*r(i-1)*c(i-1)*(m(i-1)+1)^2)+... (-0.25*r(i+1)*c(i+1)*(m(i+1)-1)^2) - (-0.25*r(i)*c(i)*(m(i)-1)^2)    ); run(i)=ru(i)-(dt/h)*(... ( 0.25*r(i)*c(i)    *(m(i)+1)^2)  *(( 1+0.5*(gg-1)*m(i))  *2*c(i)  /gg) - ... ( 0.25*r(i-1)*c(i-1)*(m(i-1)+1)^2)*(( 1+0.5*(gg-1)*m(i-1))*2*c(i-1)/gg) + ... (-0.25*r(i+1)*c(i+1)*(m(i+1)-1)^2)*((-1+0.5*(gg-1)*m(i+1))*2*c(i+1)/gg) - ... (-0.25*r(i)*c(i)    *(m(i)-1)^2)  *((-1+0.5*(gg-1)*m(i))  *2*c(i)  /gg)    );  rEn(i)=rE(i)-(dt/h)*(... ( 0.25*r(i)*c(i)    *(m(i)+1)^2)  *((1+0.5*(gg-1)*m(i))^2  *2*c(i)^2  /(gg^2-1)) - ... ( 0.25*r(i-1)*c(i-1)*(m(i-1)+1)^2)*((1+0.5*(gg-1)*m(i-1))^2*2*c(i-1)^2/(gg^2-1)) + ... (-0.25*r(i+1)*c(i+1)*(m(i+1)-1)^2)*((1-0.5*(gg-1)*m(i+1))^2*2*c(i+1)^2/(gg^2-1)) - ... (-0.25*r(i)*c(i)    *(m(i)-1)^2)  *((1-0.5*(gg-1)*m(i))^2  *2*c(i)^2  /(gg^2-1))     );endr=rn;ru=run;rE=rEn;%hold off;plot(x,r,'linewidth',2);text(7.5,1.0,'Density','fontsize',24),axis([0 xl 0 1.1])%hold off;plot(x,m,'linewidth',2);text(6.0,1.0,'Mach Number','fontsize',24),axis([0 xl 0 1.1])%hold off;plot(x,ru,'linewidth',2);text(7.0,135,'Mass Flux','fontsize',24),axis([0 xl 0 150])%set(gca,'fontsize',24);set(gca,'linewidt',2)plot(r,'r','linewidth',2);pause(0.5)time=time+dt,istep%hold on%	plot(p,'r'),axis([0 81 0 150000])%hold off%pauseendfor i=1:nx,p(i)=r(i)*c(i)^2/gg;end%hold on;plot(x,r,'r','linewidth',2);text(7.5,1.0,'Density','fontsize',24),axis([0 xl 0 1.1])%hold on;plot(x,p,'r','linewidth',2);text(7.,100000.0,'Pressure','fontsize',24),axis([0 xl 0 1.1*max(p)])%set(gca,'fontsize',24);set(gca,'linewidt',2)